 name: Replace Secrets in JS
  run: |
  echo "CLIENT_ID_VALUE: $CLIENT_ID_VALUE"
  echo "SPREADSHEET_ID_VALUE: $SPREADSHEET_ID_VALUE"
  echo "API_KEY_VALUE: $API_KEY_VALUE"

    if [ ! -f script.js ]; then
      echo "Error: script.js not found!"
      exit 1
    fi

    if [ -z "$CLIENT_ID_VALUE" ] || [ -z "$SPREADSHEET_ID_VALUE" ] || [ -z "$API_KEY_VALUE" ]; then
      echo "Error: One or more secrets are missing!"
      exit 1
    fi

    sed -i "s@{{ GITHUB_SECRET_CLIENT_ID }}@$CLIENT_ID_VALUE@g" script.js
    sed -i "s@{{ GITHUB_SECRET_SPREADSHEET_ID }}@$SPREADSHEET_ID_VALUE@g" script.js
    sed -i "s@{{ GITHUB_SECRET_API_KEY }}@$API_KEY_VALUE@g" script.js

    if grep -q "{{ GITHUB_SECRET_" script.js; then
      echo "Error: Some placeholders were not replaced in script.js"
      exit 1
    fi

    echo "Secrets replaced in script.js"
  env:
    CLIENT_ID_VALUE: ${{ secrets.CLIENT_ID }}
    SPREADSHEET_ID_VALUE: ${{ secrets.SPREADSHEET_ID }}
    API_KEY_VALUE: ${{ secrets.API_KEY }}
